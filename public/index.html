<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body { padding:20px; font-size:20px; }
  #unlockBtn, #startBtn {
    font-size:22px;
    padding:12px 20px;
    margin:10px 0;
    display:block;
    width:100%;
  }
</style>

</head>
<body>

<button id="unlockBtn">ðŸ”Š Activar sonido</button>
<button id="startBtn" disabled>ðŸŽ¤ Speak</button>

<script>
const isIphone = /iPhone|iPad|iPod/i.test(navigator.userAgent);
const unlockBtn = document.getElementById("unlockBtn");
const startBtn  = document.getElementById("startBtn");

let audioContext = null;
let audioUnlocked = false;

async function unlockAudio() {
  if (!isIphone) return;
  if (audioUnlocked) return;

  try {
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
    await audioContext.resume();

    const silent = new Audio();
    silent.src = "data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA...";
    await silent.play().catch(()=>{});

    const buffer = audioContext.createBuffer(1, 1, audioContext.sampleRate);
    const source = audioContext.createBufferSource();
    source.buffer = buffer;
    source.connect(audioContext.destination);
    source.start(0);

  } catch(e) {
    console.log("unlock error", e);
  }

  audioUnlocked = true;
  startBtn.disabled = false;
  unlockBtn.disabled = true;
  unlockBtn.textContent = "Sonido activado";
}

unlockBtn.addEventListener("click", unlockAudio);
</script>

</body>
</html>
